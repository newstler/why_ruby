<%# 
  Repository tile partial - displays a GitHub repository in a card format
  Locals:
    - repository: the repository hash to display
%>

<div class="group bg-white shadow-md rounded-lg p-6 hover:shadow-2xl hover:scale-[1.02] transform transition-all duration-300 ease-out relative">
  <%= link_to repository[:url], target: "_blank", rel: "noopener", class: "block" do %>
    <!-- Repository Name with Stars -->
    <div class="flex items-start justify-between mb-2">
      <h3 class="text-xl font-semibold text-gray-900 group-hover:text-red-600 transition-colors flex-1">
        <%= repository[:name] %>
      </h3>
      <% if repository[:stars] && repository[:stars] > 0 %>
        <span class="flex items-center text-gray-600 ml-2">
          <%= inline_svg_tag "star.svg", class: "w-4 h-4 mr-1 text-yellow-500" %>
          <span class="font-semibold"><%= repository[:stars] %></span>
        </span>
      <% end %>
    </div>
    
    <!-- Repository Description -->
    <% if repository[:description].present? %>
      <p class="text-gray-600 mb-4 line-clamp-2">
        <%= repository[:description] %>
      </p>
    <% else %>
      <p class="text-gray-400 italic mb-4">
        <%= t('users.repository_tile.no_description') %>
      </p>
    <% end %>
    
    <!-- Repository Metrics -->
    <div class="space-y-2">
      <!-- Topics/Tags if present -->
      <% if repository[:topics] && repository[:topics].any? %>
        <div class="flex flex-wrap gap-1 mb-2">
          <% repository[:topics].take(4).each do |topic| %>
            <span class="text-xs bg-gray-100 text-gray-700 px-2 py-1 rounded-full"><%= topic %></span>
          <% end %>
          <% if repository[:topics].size > 4 %>
            <span class="text-xs text-gray-500">+<%= repository[:topics].size - 4 %></span>
          <% end %>
        </div>
      <% end %>
      
      <!-- Stats row -->
      <div class="flex items-center justify-between text-xs text-gray-500">
        <div class="flex items-center gap-4">
          <% if repository[:forks_count] && repository[:forks_count] > 0 %>
            <span class="flex items-center">
              <%= inline_svg_tag "fork.svg", class: "w-3.5 h-3.5 mr-1" %>
              <%= t('users.repository_tile.forks', count: repository[:forks_count]) %>
            </span>
          <% end %>
          
          <% if repository[:size] && repository[:size] > 0 %>
            <span class="flex items-center">
              <%= inline_svg_tag "file.svg", class: "w-3.5 h-3.5 mr-1" %>
              <%= t('users.repository_tile.size', size: number_to_human_size(repository[:size] * 1024)) %>
            </span>
          <% end %>
        </div>
        
        <!-- Last commit aligned to the right -->
        <% if repository[:pushed_at].present? %>
          <span class="text-gray-400">
            <%= t('users.repository_tile.last_commit', time_ago: time_ago_in_words(Time.parse(repository[:pushed_at]))) %>
          </span>
        <% end %>
      </div>
    </div>
  <% end %>
</div>
