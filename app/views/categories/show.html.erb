<%# Set page title %>
<% content_for(:title) { category_meta_title(@category) } %>

<%# Override meta tags for this category %>
<% content_for :head do %>
  <!-- SEO Meta Tags -->
  <meta name="description" content="<%= category_meta_description(@category) %>">
  <meta name="keywords" content="<%= category_meta_keywords(@category) %>">
  <link rel="canonical" href="<%= category_url(@category) %>">
  
  <!-- Open Graph / Facebook Meta Tags -->
  <meta property="og:type" content="website">
  <meta property="og:url" content="<%= category_url(@category) %>">
  <meta property="og:title" content="<%= category_meta_title(@category) %>">
  <meta property="og:description" content="<%= category_meta_description(@category) %>">
  <meta property="og:image" content="<%= category_meta_image_url(@category) %>">
  <meta property="og:site_name" content="<%= t('meta.site.name') %>">
  <meta property="og:locale" content="<%= I18n.locale.to_s.gsub('-', '_') %>">
  
  <!-- Twitter Card Meta Tags -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:url" content="<%= category_url(@category) %>">
  <meta name="twitter:title" content="<%= category_meta_title(@category) %>">
  <meta name="twitter:description" content="<%= category_meta_description(@category) %>">
  <meta name="twitter:image" content="<%= category_meta_image_url(@category) %>">
  <meta name="twitter:site" content="<%= t('meta.social.twitter_site') %>">
  <meta name="twitter:creator" content="<%= t('meta.social.twitter_creator') %>">
<% end %>

<div class="space-y-8">
    <div class="mb-8">
      <h1 class="text-4xl font-bold text-gray-900 mb-4"><%= @category.name %></h1>
      <% if @category.description.present? %>
        <p class="text-lg text-gray-600">
          <%= @category.description %>
        </p>
      <% end %>
    </div>

  <div class="space-y-4">
    <% if @posts.any? %>
      <div class="hidden lg:flex gap-6">
        <% # Split posts into 3 columns for desktop, maintaining left-to-right reading order %>
        <% column1_posts = [] %>
        <% column2_posts = [] %>
        <% column3_posts = [] %>
        
        <% @posts.each_with_index do |post, index| %>
          <% case index % 3 %>
          <% when 0 %>
            <% column1_posts << post %>
          <% when 1 %>
            <% column2_posts << post %>
          <% when 2 %>
            <% column3_posts << post %>
          <% end %>
        <% end %>
        
        <% # Desktop: 3 columns %>
        <% [column1_posts, column2_posts, column3_posts].each do |column_posts| %>
          <div class="flex-1 space-y-6">
            <% column_posts.each do |post| %>
              <%= render 'posts/post_tile', post: post %>
            <% end %>
          </div>
        <% end %>
      </div>
      
      <% # Tablet: 2 columns %>
      <div class="hidden md:flex lg:hidden gap-6">
        <% column1_posts = [] %>
        <% column2_posts = [] %>
        
        <% @posts.each_with_index do |post, index| %>
          <% if index % 2 == 0 %>
            <% column1_posts << post %>
          <% else %>
            <% column2_posts << post %>
          <% end %>
        <% end %>
        
        <% [column1_posts, column2_posts].each do |column_posts| %>
          <div class="flex-1 space-y-6">
            <% column_posts.each do |post| %>
              <%= render 'posts/post_tile', post: post %>
            <% end %>
          </div>
        <% end %>
      </div>
      
      <% # Mobile: 1 column %>
      <div class="md:hidden space-y-6">
        <% @posts.each do |post| %>
          <%= render 'posts/post_tile', post: post %>
        <% end %>
      </div>
      
      <div class="mt-12 mb-8 text-center">
        <% if user_signed_in? %>
          <%= link_to "Share what you love about Ruby →", new_post_path, 
              class: "text-gray-400 hover:text-gray-600 transition-colors" %>
        <% else %>
          <%= link_to "Share what you love about Ruby →", 
              github_auth_with_return_path(return_to: new_post_path),
              class: "text-gray-400 hover:text-gray-600 transition-colors" %>
        <% end %>
      </div>
      
      <div class="mt-12 flex justify-center">
        <%= paginate @posts %>
      </div>
    <% else %>
      <div class="bg-white shadow rounded-lg p-8 text-center">
        <p class="text-gray-600">No posts in this category yet.</p>
        <% if user_signed_in? %>
          <%= link_to "Create the first one", new_post_path, class: "mt-4 inline-block text-red-600 hover:text-red-800" %>
        <% end %>
      </div>
    <% end %>
  </div>
</div> 